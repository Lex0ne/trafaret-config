containers:

  py:
    setup:
    - !Alpine v3.4
    - !Py3Install [pip]
    - !Sh "pip install -e ."

  py2:
    setup:
    - !Alpine v3.4
    - !Py2Install [pip, setuptools]
    - !Sh "pip install -e ."

  doc:
    setup:
    - !Alpine v3.4
    - !Repo edge/main
    - !Install [alpine-base, py-sphinx, make]
    - &bulk !Tar
      url: "http://files.zerogw.com/bulk/bulk-0.4.7.tar.gz"
      sha256: faec9ee88ee079de3c7cfb95c5900489941b28b24b47411afaec1fae7a277546
      path: /

commands:

  test: !Command
    description: Run the only available example so far
    container: py
    run: [python3, -m, unittest, discover]

  test-py2: !Command
    description: Run the only available example so far
    container: py2
    run: [python2, -m, unittest, discover]

  example: !Command
    description: Run the only available example so far
    container: py
    run: [python3, example.py]

  doc: !Command
    description: Build documentation
    container: doc
    run: [make, html]
    work-dir: doc
    epilog: |
      --------------------------------------------------------
      Documentation is built under doc/_build/html/index.html

  bulk: !Command
    description: Run arbitrary bulk command (maintains version number)
    container: doc
    run: [bulk]
